from __future__ import division

import numpy as np

# Dave Green's `cubehelix' colour scheme
# License: Unlicense (unlicense.org)

_reds = np.array([0.0, 0.008020000000000001, 0.015780000000000002, 0.02327,
    0.030459999999999997, 0.03737, 0.04396, 0.050230000000000004, 0.05618,
    0.06179, 0.06706000000000001, 0.07198, 0.07655, 0.08077000000000001,
    0.08462, 0.08812, 0.09125, 0.09402, 0.09644, 0.0985, 0.1002, 0.10156,
    0.10257, 0.10324, 0.10359, 0.10361, 0.10332, 0.10273, 0.10184,
    0.10067000000000001, 0.09924000000000001, 0.09755, 0.09561, 0.09345,
    0.09108000000000001, 0.08850999999999999, 0.08576, 0.08284, 0.07978,
    0.07658999999999999, 0.07329, 0.06989000000000001, 0.06642, 0.06289,
    0.059329999999999994, 0.05575, 0.05217, 0.04861, 0.0451,
    0.041639999999999996, 0.038259999999999995, 0.03499, 0.03183, 0.02881,
    0.02594, 0.02325, 0.02076, 0.01847, 0.016409999999999998, 0.0146,
    0.013049999999999999, 0.01177, 0.010790000000000001, 0.01012,
    0.009770000000000001, 0.00975, 0.010079999999999999, 0.01078, 0.01184,
    0.01329, 0.015130000000000001, 0.01738, 0.02003, 0.023100000000000002,
    0.026600000000000002, 0.030520000000000002, 0.034879999999999994, 0.03968,
    0.04491, 0.0506, 0.05672, 0.06329, 0.0703, 0.07776000000000001, 0.08565,
    0.09398, 0.10274, 0.11193, 0.12153, 0.13155, 0.14197, 0.15279, 0.16399,
    0.17556, 0.1875, 0.19979, 0.21242, 0.22537, 0.23864, 0.25218999999999997,
    0.26603, 0.28013, 0.29447999999999996, 0.30905, 0.32384, 0.33881, 0.35396,
    0.36927, 0.38471, 0.40027, 0.41592, 0.43165000000000003, 0.44743, 0.46324,
    0.47907, 0.49489, 0.51068, 0.52642, 0.54209, 0.55767, 0.57314, 0.58848,
    0.6036699999999999, 0.61868, 0.6335, 0.64812, 0.6625, 0.67664, 0.69051,
    0.7041000000000001, 0.7174, 0.73037, 0.74302, 0.75532, 0.76727, 0.77884,
    0.79002, 0.80081, 0.81118, 0.8211400000000001, 0.83067, 0.8397600000000001,
    0.84841, 0.8565999999999999, 0.86434, 0.87161, 0.87841, 0.88474, 0.89059,
    0.89597, 0.90088, 0.9053, 0.90926, 0.9127400000000001, 0.9157500000000001,
    0.91829, 0.92038, 0.92201, 0.9231900000000001, 0.92393, 0.92424, 0.92413,
    0.9236, 0.9226800000000001, 0.92136, 0.91967, 0.91761, 0.9152, 0.91246,
    0.90939, 0.90602, 0.9023599999999999, 0.89843, 0.89424, 0.88981,
    0.8851699999999999, 0.88032, 0.8753000000000001, 0.87011,
    0.8647699999999999, 0.85932, 0.85376, 0.8481099999999999, 0.8424, 0.83665,
    0.83087, 0.82508, 0.81932, 0.81358, 0.80791, 0.8023, 0.79679, 0.79139,
    0.78612, 0.781, 0.77604, 0.7712699999999999, 0.7666900000000001, 0.76233,
    0.7582, 0.75431, 0.75069, 0.74733, 0.74427, 0.7415, 0.7390300000000001,
    0.7368899999999999, 0.7350800000000001, 0.7336, 0.7324700000000001,
    0.73169, 0.73127, 0.73122, 0.73153, 0.7322200000000001, 0.73327, 0.73471,
    0.7365200000000001, 0.7387, 0.74126, 0.74419, 0.74749, 0.75115, 0.75518,
    0.75955, 0.76427, 0.76933, 0.77471, 0.78042, 0.78643, 0.79274, 0.79933,
    0.80619, 0.81332, 0.8206800000000001, 0.8282700000000001, 0.83608,
    0.8440799999999999, 0.85225, 0.86059, 0.86907, 0.87768, 0.88639,
    0.8951800000000001, 0.9040400000000001, 0.9129499999999999,
    0.9218799999999999, 0.93081, 0.93973, 0.94862, 0.95745, 0.96619, 0.97484,
    0.98338, 0.99177, 1.0])

_greens = np.array([0.0, 0.0013599999999999999, 0.00279, 0.00432, 0.00594,
    0.007670000000000001, 0.009510000000000001, 0.011470000000000001, 0.01357,
    0.015799999999999998, 0.01818, 0.0207, 0.02339, 0.02623, 0.02925, 0.03243,
    0.0358, 0.03934, 0.04306, 0.04697, 0.05106, 0.05535, 0.05982, 0.06448,
    0.06933, 0.07436, 0.07959, 0.085, 0.09058999999999999, 0.09636, 0.10231,
    0.10844000000000001, 0.11473000000000001, 0.12118, 0.1278, 0.13457,
    0.14148999999999998, 0.14855, 0.15574000000000002, 0.16306,
    0.17049999999999998, 0.17806, 0.18572000000000002, 0.19347, 0.20132,
    0.20924, 0.21723, 0.22527999999999998, 0.23337999999999998, 0.24152,
    0.24969, 0.25788, 0.26608, 0.27428, 0.28248, 0.29065, 0.29879, 0.30689,
    0.31495, 0.32294, 0.33086, 0.33869, 0.34644, 0.35409, 0.36163, 0.36904,
    0.37633, 0.38349, 0.39049, 0.39735000000000004, 0.40403999999999995,
    0.41056000000000004, 0.4169, 0.42306000000000005, 0.42902999999999997,
    0.43481, 0.44038, 0.44574, 0.45089, 0.45582, 0.46052, 0.46501000000000003,
    0.46926, 0.47328000000000003, 0.47707, 0.48062, 0.48394000000000004,
    0.48701, 0.48985, 0.49245, 0.4948, 0.49693000000000004,
    0.49881000000000003, 0.50047, 0.50189, 0.5030899999999999,
    0.5040600000000001, 0.50481, 0.50534, 0.50566, 0.5057799999999999, 0.50569,
    0.50541, 0.50495, 0.5043, 0.50348, 0.50249, 0.50135, 0.50005, 0.49862,
    0.49705, 0.49536, 0.49355, 0.49165000000000003, 0.48963999999999996,
    0.48756, 0.4854, 0.48318, 0.4809, 0.47859, 0.47624, 0.47387, 0.47149,
    0.46912000000000004, 0.46675999999999995, 0.46442, 0.46212,
    0.45986000000000005, 0.45766, 0.45552000000000004, 0.45346000000000003,
    0.45149, 0.44961999999999996, 0.44785, 0.44620000000000004, 0.44468,
    0.44329999999999997, 0.44206, 0.44097, 0.44005, 0.4393, 0.43873, 0.43834,
    0.43814000000000003, 0.43814000000000003, 0.43835, 0.43877,
    0.43940999999999997, 0.44027, 0.44136000000000003, 0.44267, 0.44422,
    0.44601, 0.44803, 0.4503, 0.45281, 0.45557, 0.45857, 0.46182, 0.46531,
    0.46904999999999997, 0.47302999999999995, 0.47725, 0.48171, 0.48641,
    0.49135, 0.49651, 0.5019, 0.50751, 0.51334, 0.5193800000000001, 0.52562,
    0.53207, 0.53871, 0.5455300000000001, 0.55253, 0.5597, 0.56704, 0.57453,
    0.58217, 0.58994, 0.59785, 0.60587, 0.6140100000000001, 0.62224, 0.63056,
    0.63897, 0.6474399999999999, 0.6559699999999999, 0.6645599999999999,
    0.67318, 0.68184, 0.69051, 0.69919, 0.70786, 0.71653, 0.72517, 0.73378,
    0.74235, 0.7508699999999999, 0.75932, 0.76771, 0.7760100000000001, 0.78422,
    0.7923399999999999, 0.80035, 0.8082400000000001, 0.81601, 0.82365, 0.83116,
    0.8385199999999999, 0.84573, 0.85278, 0.85968, 0.8664, 0.8729600000000001,
    0.8793300000000001, 0.8855299999999999, 0.89155, 0.89738, 0.90302, 0.90847,
    0.9137299999999999, 0.9188000000000001, 0.92367, 0.92835, 0.93284, 0.93715,
    0.94126, 0.94518, 0.94892, 0.9524900000000001, 0.95587, 0.95908, 0.96213,
    0.96501, 0.96773, 0.9703, 0.9727300000000001, 0.97502, 0.97718, 0.97922,
    0.9811500000000001, 0.98296, 0.98468, 0.98632, 0.9878699999999999, 0.98936,
    0.99078, 0.99216, 0.9935, 0.99481, 0.9961099999999999, 0.9974,
    0.9986900000000001, 1.0])

_blues = np.array([0.0, 0.00662, 0.013529999999999999, 0.02072, 0.02817,
    0.03587, 0.043789999999999996, 0.05192, 0.06024, 0.06873, 0.07738, 0.08616,
    0.09505, 0.10404000000000001, 0.11311, 0.12222999999999999, 0.13139,
    0.14056, 0.14973, 0.15887, 0.16796999999999998, 0.17701,
    0.18596000000000001, 0.19480999999999998, 0.20354, 0.21212,
    0.22055000000000002, 0.22881, 0.23687000000000002, 0.24472, 0.25234,
    0.25972, 0.26685000000000003, 0.2737, 0.28027, 0.28655, 0.29251, 0.29815,
    0.30347, 0.30844, 0.31305999999999995, 0.31732, 0.32122, 0.32475, 0.3279,
    0.33066999999999996, 0.33306, 0.33505999999999997, 0.33666999999999997,
    0.33790000000000003, 0.33873, 0.33918, 0.33924000000000004, 0.33892,
    0.33823, 0.33716, 0.33571999999999996, 0.33393, 0.33177999999999996,
    0.32929, 0.32647, 0.32332, 0.31986000000000003, 0.31610000000000005,
    0.31205, 0.30772, 0.30314, 0.2983, 0.29324, 0.28796, 0.28248, 0.27682,
    0.271, 0.26503, 0.25893000000000005, 0.25272, 0.24642, 0.24004999999999999,
    0.23362, 0.22717, 0.2207, 0.21423999999999999, 0.20781, 0.20143, 0.19511,
    0.18889, 0.18277, 0.17678, 0.17094, 0.16527, 0.15977999999999998, 0.1545,
    0.14944, 0.14463, 0.14007999999999998, 0.1358, 0.13182, 0.12815,
    0.12480000000000001, 0.1218, 0.11915, 0.11687, 0.11497, 0.11347,
    0.11238000000000001, 0.1117, 0.11146, 0.11164, 0.11227999999999999,
    0.11337, 0.11491, 0.11692, 0.11940999999999999, 0.12237, 0.1258,
    0.12971000000000002, 0.13411, 0.13899, 0.14434, 0.15018, 0.15649, 0.16328,
    0.17054, 0.17826, 0.18643, 0.19505999999999998, 0.20413,
    0.21363000000000001, 0.22356, 0.2339, 0.24464, 0.25578, 0.26729, 0.27916,
    0.29139000000000004, 0.30395, 0.31683, 0.33002000000000004, 0.34349,
    0.35723, 0.37123, 0.38545999999999997, 0.39990000000000003, 0.41454,
    0.42936, 0.44433, 0.45945, 0.47468000000000005, 0.49001, 0.50541, 0.52087,
    0.53637, 0.55188, 0.56739, 0.58287, 0.5982999999999999, 0.61367, 0.62895,
    0.6441199999999999, 0.6591600000000001, 0.67406, 0.6888, 0.70335, 0.7177,
    0.73183, 0.74573, 0.75937, 0.77275, 0.78584, 0.7986300000000001, 0.81111,
    0.82326, 0.83508, 0.8465400000000001, 0.85765, 0.86838, 0.87873, 0.88869,
    0.89825, 0.90741, 0.9161499999999999, 0.92448, 0.9324, 0.9398799999999999,
    0.94695, 0.95358, 0.95979, 0.96558, 0.9709300000000001, 0.9758699999999999,
    0.98038, 0.9844799999999999, 0.98817, 0.99146, 0.99435, 0.99684,
    0.9989600000000001, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
    0.9987900000000001, 0.99707, 0.99516, 0.99309, 0.99086, 0.9884999999999999,
    0.98603, 0.9834700000000001, 0.98083, 0.9781299999999999, 0.9754,
    0.9726499999999999, 0.96991, 0.96718, 0.9644999999999999,
    0.9618800000000001, 0.95934, 0.9568899999999999, 0.9545699999999999,
    0.95237, 0.95033, 0.9484600000000001, 0.94677, 0.94528, 0.94402, 0.94298,
    0.9422, 0.94167, 0.9414199999999999, 0.94145, 0.94179, 0.94243, 0.94339,
    0.9446800000000001, 0.9463100000000001, 0.94828, 0.9506,
    0.9532700000000001, 0.9563, 0.9597, 0.96346, 0.96759, 0.97209, 0.97695,
    0.98217, 0.9877600000000001, 0.9936999999999999, 1.0])

def colorize(z, z_min=0, z_max = 100):
    z = (z - z_min) * 255/(z_max - z_min)
    z = z.clip(0, 255).astype('B')
    return np.transpose(
        np.array([_reds[z], _greens[z], _blues[z]]),
        axes=(1, 2, 0)
    )

def colorize_1d(z, z_min=0, z_max=100):
    z = (z - z_min) * 255 / (z_max - z_min)
    z = z.clip(0, 255).astype('B')
    return np.array([_reds[z], _greens[z], _blues[z], np.ones_like(z)]).T